import axios from 'axios';
import type { NextApiRequest, NextApiResponse } from 'next';
import { NextResponse } from 'next/server';

export interface PropertyResponse {
    property?: Property;
    message: string;
}

export interface Property {
    BedroomsTotal:                         number;
    ShowingInstructions:                   string;
    GreenWaterConservation:                any[];
    CoolingYN:                             boolean;
    InsuranceExpense:                      null;
    RoomKitchenLevel:                      string;
    LotSizeUnits:                          string;
    MLSPIN_MARKET_TIME_BROKER:             number;
    MLSPIN_LEVELS_1:                       null;
    LaundryFeatures:                       string[];
    Flooring:                              string[];
    RoomBathroom2Level:                    string;
    PhotosCount:                           number;
    FireplacesTotal:                       number;
    AdditionalParcelsYN:                   null;
    RoomBathroom1Area:                     null;
    WaterfrontFeatures:                    any[];
    MLSPIN_SQUARE_FEET_INCL_BASE:          string;
    PastureArea:                           null;
    SubAgencyCompensation:                 null;
    MLSPIN_SOLD_VS_RENT:                   null;
    ViewYN:                                null;
    SeniorCommunityYN:                     boolean;
    Cooling:                               string[];
    GarageYN:                              boolean;
    ExteriorFeatures:                      string[];
    MLSPIN_TEAM_MEMBER:                    string;
    MLSPIN_SQUARE_FEET_OTHER:              null;
    StatusChangeTimestamp:                 Date;
    Longitude:                             number;
    AvailabilityDate:                      null;
    SecurityFeatures:                      any[];
    MLSPIN_DEQE:                           null;
    RoomBedroom2Level:                     string;
    DocumentsCount:                        number;
    PrivateOfficeRemarks:                  null;
    CarportYN:                             null;
    PublicRemarks:                         string;
    MLSPIN_SUB_AGENCY_OFFERED:             string;
    MLSPIN_SELLER_DISCOUNT_PTS:            null;
    FinancialDataSource:                   any[];
    BuildingName:                          string;
    AssociationFeeFrequency:               string;
    CurrentFinancing:                      any[];
    MLSPIN_LEAD_PAINT:                     string[];
    RoomBedroom5Length:                    null;
    RoomBedroom4Area:                      number;
    MLSPIN_OFFLINE_LIST_NO:                number;
    RoomDiningRoomWidth:                   number;
    HeatingYN:                             boolean;
    RoomBedroom3Features:                  any[];
    MLSPIN_MARKET_TIME_BROKER_PREV:        number;
    MLSPIN_SQUARE_FEET_DISCLOSURES:        string;
    PurchaseContractDate:                  null;
    RoadSurfaceType:                       any[];
    RoomDiningRoomFeatures:                any[];
    ListingContractDate:                   Date;
    MLSAreaMinor:                          null;
    FarmLandAreaUnits:                     string;
    RoomBathroom1Features:                 string[];
    Zoning:                                string;
    MLSPIN_MGF:                            null;
    MLSPIN_COMPLEX_COMPLETE:               null;
    MLSPIN_MASTER_PAGE:                    null;
    GreenIndoorAirQuality:                 any[];
    MLSPIN_AUCTION_BUYERS_PREMIUM_PERCENT: null;
    Appliances:                            string[];
    MLSPIN_AvailableNow:                   null;
    MLSAreaMajor:                          null;
    TaxAnnualAmount:                       number;
    RoomKitchenWidth:                      number;
    TaxBlock:                              null;
    RoomBedroom4Length:                    number;
    RoomLivingRoomLength:                  number;
    MLSPIN_ENTERED_BY:                     string;
    MLSPIN_OH_FLAG:                        number;
    RoomBedroom2Features:                  any[];
    MLSPIN_DEPOSIT_REQD:                   null;
    MLSPIN_REQD_OWN_ASSOCIATION:           null;
    Basement:                              string[];
    OriginatingSystemKey:                  string;
    BusinessType:                          any[];
    CountyOrParish:                        string;
    DualVariableCompensationYN:            null;
    Latitude:                              number;
    MLSPIN_OPT_FEE_INCLUDES:               any[];
    PropertyType:                          string;
    BathroomsTotalDecimal:                 number;
    PhotosChangeTimestamp:                 Date;
    ListPrice:                             number;
    RoadFrontageType:                      any[];
    RoomBathroom2Area:                     null;
    RoomBedroom3Width:                     number;
    OriginatingSystemName:                 string;
    RoomBedroom2Width:                     number;
    RoomBathroom1Length:                   null;
    GreenEnergyGeneration:                 any[];
    AssociationYN:                         boolean;
    MlsStatus:                             string;
    FoundationArea:                        null;
    MLSPIN_SHOWINGS_DEFERRAL_DATE:         null;
    RoomFamilyRoomLength:                  null;
    StreetNumber:                          string;
    GrossScheduledIncome:                  null;
    MLSPIN_FIRST_MON_REQD:                 null;
    ElectricExpense:                       null;
    MLSPIN_OWNER_OCC_SOURCE:               null;
    MLSPIN_MARKET_TIME_PROPERTY_PREV:      number;
    LeaseTerm:                             null;
    ListingKey:                            string;
    MLSPIN_RFS:                            null;
    RoomBedroom3Length:                    number;
    StateOrProvince:                       string;
    CommonWalls:                           string[];
    RoomBathroom3Width:                    null;
    MLSPIN_UNIT_BUILDING:                  string;
    RoomMasterBedroomFeatures:             any[];
    CoveredSpaces:                         number;
    MiddleOrJuniorSchool:                  null;
    MLSPIN_MAIN_LO:                        string;
    AssociationFeeIncludes:                string[];
    MLSPIN_MARKET_TIME_PROPERTY:           number;
    SyndicateTo:                           null;
    RoomBedroom5Level:                     null;
    Gas:                                   any[];
    MLSPIN_GRE:                            null;
    ElementarySchool:                      null;
    FrontageLength:                        null;
    MLSPIN_H_BTHS_1:                       null;
    MLSPIN_H_BTHS_2:                       null;
    MLSPIN_H_BTHS_3:                       null;
    MLSPIN_HTE:                            null;
    MLSPIN_H_BTHS_4:                       null;
    RoomBedroom2Length:                    number;
    MLSPIN_COOLING_UNITS:                  null;
    Disclosures:                           any[];
    RoomBathroom2Width:                    null;
    RoomBedroom4Level:                     string;
    RoomLivingRoomLevel:                   string;
    TaxMapNumber:                          null;
    FireplaceYN:                           boolean;
    Directions:                            string;
    MLSPIN_HOT_WATER:                      any[];
    MLSPIN_SyndicateToCurrentUser:         boolean;
    BridgeModificationTimestamp:           Date;
    EntryLevel:                            number;
    YearBuiltEffective:                    number;
    AttachedGarageYN:                      null;
    RoomBedroom5Features:                  any[];
    MLSPIN_TITLE5:                         null;
    TaxBookNumber:                         string;
    MainLevelBathrooms:                    null;
    StandardStatus:                        string;
    CultivatedArea:                        null;
    MLSPIN_MASTER_BOOK:                    null;
    Roof:                                  string[];
    RoomFamilyRoomLevel:                   null;
    PropertyCondition:                     any[];
    ParkingTotal:                          number;
    FrontageType:                          any[];
    DevelopmentStatus:                     any[];
    GrossIncome:                           null;
    ParcelNumber:                          string;
    PoolPrivateYN:                         null;
    MLSPIN_SOLD_PRICE_PER_SQFT:            null;
    ListingTerms:                          any[];
    MLSPIN_LEVELS_4:                       null;
    RoomKitchenLength:                     number;
    MLSPIN_LEVELS_2:                       null;
    MLSPIN_LEVELS_3:                       null;
    MLSPIN_PAGE:                           string;
    FoundationDetails:                     any[];
    View:                                  any[];
    OperatingExpense:                      null;
    SignOnPropertyYN:                      null;
    RoomDiningRoomLength:                  number;
    PropertySubType:                       string;
    MLSPIN_ALERT_COMMENTS:                 null;
    RoomBathroom3Features:                 string[];
    YearBuiltDetails:                      string;
    Possession:                            any[];
    HighSchool:                            null;
    HomeWarrantyYN:                        boolean;
    Levels:                                any[];
    RoomBedroom3Area:                      number;
    IDXParticipationYN:                    boolean;
    InteriorFeatures:                      string[];
    BathroomsFull:                         number;
    WaterfrontYN:                          boolean;
    LotSizeAcres:                          null;
    SubdivisionName:                       null;
    OffMarketDate:                         null;
    SpecialLicenses:                       any[];
    RoomBathroom3Level:                    string;
    Fencing:                               any[];
    MLSPIN_AUCTION_DEPOSIT:                null;
    RoomBedroom4Features:                  any[];
    MLSPIN_RealtorComDisplayAddress:       boolean;
    MLSPIN_SEWAGE_DISTRICT:                null;
    MLSPIN_PHOTO_MASK:                     number;
    Contingency:                           null;
    CloseDate:                             null;
    ListAgentMlsId:                        string;
    HorseAmenities:                        any[];
    ListingService:                        null;
    WaterSource:                           string[];
    MLSPIN_PERC_TEST:                      null;
    WaterSewerExpense:                     null;
    RoomMasterBedroomLevel:                string;
    MLSPIN_BEDRMS_4:                       null;
    MLSPIN_WATERVIEW_FLAG:                 null;
    MLSPIN_BEDRMS_3:                       null;
    SubAgencyCompensationType:             null;
    MLSPIN_BEDRMS_2:                       null;
    MLSPIN_RENT1:                          null;
    MLSPIN_BEDRMS_1:                       null;
    DoorFeatures:                          any[];
    MLSPIN_RENT2:                          null;
    StoriesTotal:                          number;
    MLSPIN_ANT_SOLD_DATE:                  null;
    ModificationTimestamp:                 Date;
    YearBuilt:                             number;
    MLSPIN_RENT3:                          null;
    MLSPIN_RENT4:                          null;
    ElectricOnPropertyYN:                  null;
    RoomBedroom5Area:                      null;
    PropertyAttachedYN:                    null;
    TaxLot:                                null;
    MLSPIN_LIST_PRICE_PER_SQFT:            number;
    MLSPIN_DISCLOSURE:                     string;
    MLSPIN_HEAT_UNITS:                     null;
    OriginatingSystemID:                   string;
    RoomOfficeLength:                      null;
    ZoningDescription:                     null;
    RoomBathroom3Area:                     null;
    RoomOfficeLevel:                       null;
    RoomBathroom1Level:                    string;
    HorseYN:                               null;
    PetsAllowed:                           string[];
    MLSPIN_MANAGEMENT:                     string[];
    MLSPIN_COLOR:                          null;
    RoomOfficeArea:                        null;
    RoomBathroom2Features:                 string[];
    RoomBathroom3Length:                   null;
    Country:                               string;
    UnitNumber:                            string;
    RoomKitchenFeatures:                   any[];
    OpenParkingYN:                         null;
    TransactionBrokerCompensation:         string;
    BuyerAgencyCompensationType:           null;
    NetOperatingIncome:                    null;
    MLSPIN_PRICE_PER_SQFT:                 number;
    OtherStructures:                       any[];
    AssociationAmenities:                  any[];
    MLSPIN_LEASE_4:                        null;
    RoomBedroom2Area:                      number;
    MLSPIN_LEASE_3:                        null;
    RoomLivingRoomArea:                    number;
    BodyType:                              any[];
    ListOfficeMlsId:                       string;
    MLSPIN_INSURANCE_REQD:                 null;
    ClosePrice:                            null;
    RoomBathroom2Length:                   null;
    MLSPIN_MARKET_TIME:                    number;
    ConcessionsAmount:                     null;
    MLSPIN_YEAR_ROUND:                     null;
    RoomBathroom1Width:                    null;
    MLSPIN_LEASE_2:                        null;
    StreetNumberNumeric:                   number;
    MLSPIN_LEASE_1:                        null;
    EntryLocation:                         null;
    RoomFamilyRoomFeatures:                any[];
    SpaYN:                                 boolean;
    MLSPIN_WATERVIEW_FEATURES:             any[];
    SpaFeatures:                           any[];
    LivingArea:                            number;
    TaxAssessedValue:                      number;
    ExistingLeaseType:                     any[];
    MLSPIN_COMP_BASED_ON:                  string;
    ParkingFeatures:                       string[];
    PostalCodePlus4:                       null;
    BathroomsHalf:                         number;
    RoomBedroom3Level:                     string;
    MLSPIN_LAST_MON_REQD:                  null;
    MLSPIN_AUCTION_TERMS:                  null;
    RoomLivingRoomFeatures:                any[];
    PoolFeatures:                          any[];
    LotSizeArea:                           null;
    Sewer:                                 string[];
    ExpirationDate:                        Date;
    Heating:                               string[];
    StructureType:                         string[];
    BuildingAreaSource:                    string;
    MLSPIN_UFFI:                           null;
    TotalActualRent:                       null;
    RoomKitchenArea:                       number;
    MLSPIN_VT_FLAG:                        null;
    MLSPIN_REFERENCES_REQD:                null;
    MLSPIN_FLRS_1:                         null;
    StreetName:                            string;
    PatioAndPorchFeatures:                 string[];
    MLSPIN_PREV_MARKET_TIME:               null;
    NumberOfLots:                          null;
    MainLevelBedrooms:                     null;
    MLSPIN_HEAT_ZONES:                     number;
    MLSPIN_SEC_DEPOSIT:                    null;
    MLSPIN_FLRS_4:                         null;
    MLSPIN_FLRS_3:                         null;
    MLSPIN_PERC_TEST_DATE:                 null;
    MLSPIN_FLRS_2:                         null;
    ListingAgreement:                      string;
    RoadResponsibility:                    any[];
    Utilities:                             string[];
    MLSPIN_APOD_AVAILABLE:                 null;
    FireplaceFeatures:                     any[];
    ListingId:                             string;
    WindowFeatures:                        any[];
    SpecialListingConditions:              any[];
    CommunityFeatures:                     string[];
    BathroomsTotalInteger:                 number;
    MLSPIN_MAIN_SO:                        null;
    RoomsTotal:                            number;
    GarageSpaces:                          number;
    OriginalListPrice:                     number;
    RoomLivingRoomWidth:                   number;
    GreenEnergyEfficient:                  any[];
    MLSPIN_COOP_COMP:                      null;
    RoomDiningRoomLevel:                   string;
    Media:                                 Media[];
    RoomMasterBedroomLength:               number;
    BuildingAreaUnits:                     string;
    RentIncludes:                          any[];
    City:                                  string;
    RoomMasterBedroomWidth:                number;
    MLSPIN_F_BTHS_1:                       null;
    BuyerAgencyCompensation:               string;
    MLSPIN_F_BTHS_2:                       null;
    AccessibilityFeatures:                 any[];
    MLSPIN_LISTING_ALERT:                  string;
    RoomMasterBedroomArea:                 number;
    RoomBedroom4Width:                     number;
    TaxYear:                               number;
    MLSPIN_F_BTHS_3:                       null;
    MLSPIN_F_BTHS_4:                       null;
    OriginalEntryTimestamp:                Date;
    MLSPIN_CERTIFICATE_NUMBER:             null;
    RoomOfficeFeatures:                    any[];
    BuyerAgentMlsId:                       null;
    Exclusions:                            null;
    LotFeatures:                           any[];
    PostalCode:                            string;
    MLSPIN_NO_UNITS_OWNER_OCC:             number;
    BuyerOfficeMlsId:                      null;
    DocumentsAvailable:                    string[];
    MLSPIN_OUTDOOR_SPACE_AVAILABLE:        null;
    ConstructionMaterials:                 string[];
    RoomOfficeWidth:                       null;
    RoomBedroom5Width:                     null;
    NumberOfUnitsTotal:                    number;
    RoomDiningRoomArea:                    number;
    AssociationFee:                        number;
    LotSizeSquareFeet:                     null;
    MLSPIN_DPR_Flag:                       string;
    TenantPays:                            any[];
    MLSPIN_MSE:                            null;
    MLSPIN_INSULATION_FEATURE:             string[];
    Electric:                              string[];
    MLSPIN_RME:                            null;
    ArchitecturalStyle:                    any[];
    RoomMasterBathroomFeatures:            string[];
    UnparsedAddress:                       string;
    MLSPIN_OPTIONAL_FEE:                   null;
    MLSPIN_COOLING_ZONES:                  string;
    WoodedArea:                            null;
    BuildingAreaTotal:                     number;
    TransactionBrokerCompensationType:     null;
    YearBuiltSource:                       string;
    RoomFamilyRoomWidth:                   null;
    OtherEquipment:                        any[];
    MLSPIN_LAUNDRY_DIMEN:                  null;
    RoomFamilyRoomArea:                    null;
    FeedTypes:                             any[];
    url:                                   string;
}

export interface Media {
    Order:             number;
    MediaKey:          string;
    MediaURL:          string;
    ResourceRecordKey: string;
    ResourceName:      string;
    ClassName:         string;
    MediaCategory:     string;
    MimeType:          string;
    MediaObjectID:     string | null;
    ShortDescription:  null | string;
}

export async function GET(    
    req: NextApiRequest,
    {params}: {params: {propertyId: string}},
    res: NextApiResponse<PropertyResponse>
    ){
        const propertyId : string = params.propertyId
        if(!propertyId){
            return res.status(404).json({
                message: "Missing id"
            });
        }

        const response =await axios.get(
            `https://api.bridgedataoutput.com/api/v2/mlspin/listings/${propertyId}?access_token=${process.env.API_ACCESS_TOKEN}`
        );
        
        return NextResponse.json({ 
            property: response.data.bundle,
            message: "Succesfully fetched single property"
        });
}